{% extends "layout.html" %}
{% load static %}
{% block title %}Home{% endblock %}
{% block Main_content %}
        <!-- Mashead header-->
        <header class="masthead">
            <div class="container px-5">
                <div class="row gx-5 align-items-center">
                   <div class="col-lg-6">
                        <div class="mb-5 mb-lg-0 text-center text-lg-start">
                            
                            <!-- Headline -->
                            <h1 class="display-4 fw-bold mb-4" style="font-family: 'Poppins', sans-serif; line-height: 1.2;">
                            <span style="color: #383838ff;font-weight:bolder;font-size: 5.5rem;font-family: 'Poppins', sans-serif;">{{company.app_name | capfirst}}</span> – छिटो र सजिलो ID कार्ड
                            </h1>

                          <!-- Description -->
                          <p class="lead text-muted mb-5 d-none d-md-block" style="font-family: 'Lato', sans-serif; font-size: 1.125rem;">
                              विद्यालय, कलेज वा अफिसका लागि भरपर्दो र छिटो सेवा।<br>
                              IDcraft ले तपाईंको ID कार्ड बनाउने काम सरल र प्रभावकारी बनाउँछ। आजै प्रयोग गर्नुहोस्!
                          </p>


                          <!-- Call to Action Buttons -->
                          <!-- Call to Action Buttons -->
                          <div class="d-flex justify-content-center align-items-center gap-3 mt-4">
                              <!-- Download Button -->
                              <div id="download-app-container">
                                  <script>
                                  document.addEventListener('DOMContentLoaded', function() {
                                      const container = document.getElementById('download-app-container');
                                      let buttonHTML = '';

                                      // URLs from Django context
                                      const androidLink = "{{ company.android_app_file.url }}" || "";
                                      const iosLink = "{{ company.ios_app_file.url }}" || "";
                                      const desktopLink = "{{ company.desktop_app_file.url }}" || "";
                                      const websiteLink = "{{ company.website }}" || "#";

                                      // Detect user platform
                                      const userAgent = navigator.userAgent || navigator.vendor || window.opera;

                                      if (/windows phone/i.test(userAgent) || /windows/i.test(userAgent)) {
                                          if(desktopLink){
                                              buttonHTML = `<a href="${desktopLink}" class="btn btn-dark btn-lg d-flex align-items-center gap-2">
                                                              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                                                  <path d="M0 3.5L10 2V10H0V3.5ZM12 2V10H24V3.5L12 2ZM0 12V21.5L10 20V12H0ZM12 12V20L24 21.5V12H12Z"/>
                                                              </svg>
                                                              Windows
                                                            </a>`;
                                          }
                                      } else if (/android/i.test(userAgent)) {
                                          if(androidLink){
                                              buttonHTML = `<a href="${androidLink}" class="btn btn-dark btn-lg d-flex align-items-center gap-2">
                                                              <i class="bi bi-android2"></i> Android
                                                            </a>`;
                                          }
                                      } else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                                          if(iosLink){
                                              buttonHTML = `<a href="${iosLink}" class="btn btn-dark btn-lg d-flex align-items-center gap-2">
                                                              <i class="bi bi-apple"></i> iOS
                                                            </a>`;
                                          }
                                      } else {
                                          buttonHTML = `<a href="${websiteLink}" class="btn btn-dark btn-lg d-flex align-items-center gap-2">
                                                          <i class="bi bi-globe"></i> Website
                                                        </a>`;
                                      }

                                      container.innerHTML = buttonHTML;
                                  });
                                  </script>
                              </div>

                              <!-- Demo Button -->
                               <a href="#!" id="demoBtn" class="btn btn-dark btn-lg d-flex align-items-center gap-2">
                                  <i class="bi bi-play-circle"></i> Demo
                              </a>


                          </div>



                        </div>
                    </div>


                    <div class="col-lg-6">
                        <!-- Masthead device mockup feature-->
                        <div class="masthead-device-mockup">
                            <!-- Circle with gradient -->
                        <svg class="circle" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <linearGradient id="circleGradient" gradientTransform="rotate(45)">
                                    <stop offset="0%"  stop-color="#2574fc11"/>
                                    <stop offset="100%" stop-color="#6b11cb57"/>
                                </linearGradient>
                            </defs>
                            <circle cx="50" cy="50" r="50" fill="url(#circleGradient)"></circle>
                        </svg>

                        <!-- Shape 1 -->
                        <svg class="shape-1 d-none d-sm-block" viewBox="0 0 240.83 240.83" xmlns="http://www.w3.org/2000/svg">
                            <rect x="-32.54" y="78.39" width="305.92" height="84.05" rx="42.03"
                                  transform="translate(120.42 -49.88) rotate(45)" fill="#ff7e5f"></rect>
                            <rect x="-32.54" y="78.39" width="305.92" height="84.05" rx="42.03"
                                  transform="translate(-49.88 120.42) rotate(-45)" fill="#feb47b"></rect>
                        </svg>

                        <!-- Shape 2 with gradient -->
                        <svg class="shape-2 d-none d-sm-block" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <linearGradient id="shape2Gradient" gradientTransform="rotate(45)">
                                    <stop offset="0%" stop-color="#6a11cb"/>
                                    <stop offset="100%" stop-color="#2575fc"/>
                                </linearGradient>
                            </defs>
                            <circle cx="50" cy="50" r="50" fill="url(#shape2Gradient)"></circle>
                        </svg>

                            <div class="device-wrapper">
                                <div class="device" data-device="iPhoneX" data-orientation="portrait" data-color="black">
                                    <div class="screen bg-black">
                                        <!-- Video covers the full screen -->
                                        <video muted autoplay loop playsinline
                                            style="width: 100%; height: 100%; object-fit: cover;">
                                            <source src="{% static 'videos/card.mp4' %}" type="video/mp4" />
                                            Your browser does not support the video tag.
                                        </video>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <section id="reviews" style="padding:4rem 0;">
          <div class="container">

            <h5 class="text-center mb-5" style="font-size:1.5rem;font-family: 'Poppins', sans-serif;">
             Client Experiences
            </h5>

            <div id="reviewsCarousel"
                class="carousel slide"
                data-bs-ride="carousel"
                data-bs-interval="4000">

              <div class="carousel-inner">

                {% for review in ratings %}

                  {% if forloop.counter0|divisibleby:3 %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div style="display:flex;gap:20px;justify-content:center;flex-wrap:wrap;">
                  {% endif %}

                      <!-- Review Card -->
                      <div style="
                        background:#fff;
                        border-radius:0px;
                        padding:1.2rem;
                        width:100%;
                        max-width:320px;border:1px solid #e0e0e0;
                        box-shadow:0 4px 12px rgba(0,0,0,0.08);
                      ">

                        <div style="display:flex;align-items:center;gap:10px;">
                          {% if review.profile_image %}
                            <img src="{{ review.profile_image.url }}"
                                style="width:40px;height:40px;border-radius:50%;object-fit:cover;">
                          {% else %}
                            <div style="
                              width:40px;height:40px;
                              border-radius:50%;
                              background:#000;
                              color:#fff;
                              display:flex;
                              align-items:center;
                              justify-content:center;
                              font-size:14px;
                            ">
                              {{ review.name|slice:":1" }} 
                            </div>
                          {% endif %}

                          <div>
                            <strong>{{ review.name }} <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-patch-check-fill" viewBox="0 0 16 16">
                                <path d="M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708"/>
                              </svg></strong>

                            <div style="display:flex;align-items:center;gap:6px;">
                              {% if review.user.is_verified %}
                                <span style="color:green;font-size:0.8rem;">Verified</span>
                              {% endif %}

                              <span style="color:#000;font-size:1.1rem;">
                                {% for i in "12345" %}
                                  {% if forloop.counter <= review.rating %}
                                    ★
                                  {% else %}
                                    ☆
                                  {% endif %}
                                {% endfor %}
                              </span>
                            </div>
                          </div>
                        </div>

                        <hr style="margin:8px 0;">
                        <p style="margin:0;font-size:0.95rem;text-align:justify;">
                          {{ review.comments|truncatechars:120 }}
                        </p>
                      </div>

                  {% if forloop.counter|divisibleby:3 or forloop.last %}
                    </div>
                  </div>
                  {% endif %}

                {% endfor %}

              </div>

             <button class="carousel-control-prev" type="button" data-bs-target="#reviewsCarousel" data-bs-slide="prev">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="black" class="bi bi-chevron-left" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L6.707 7l4.647 4.646a.5.5 0 0 1-.708.708l-5-5a.5.5 0 0 1 0-.708l5-5a.5.5 0 0 1 .708 0z"/>
                </svg>
              </button>

              <button class="carousel-control-next" type="button" data-bs-target="#reviewsCarousel" data-bs-slide="next">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="black" class="bi bi-chevron-right" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l5 5a.5.5 0 0 1 0 .708l-5 5a.5.5 0 0 1-.708-.708L9.293 7 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                </svg>
              </button>

            </div>

          </div>
    </section>




       <section id="trusted-schools" class="py-2 bg-light">
          <div class="container text-center">
            <h2 class="text-dark font-alt mb-2" style="font-size:1rem;">
              Our Trusted Clients
            </h2>

            <div class="marquee-wrapper position-relative" style="height:30px;">
              <div class="marquee">
                <div class="marquee-track">
                  {% for school in schools %}
                    <span class="school-name">
                      {% if school.website %}
                        <a href="{{ school.website }}" target="_blank" class="text-decoration-none text-dark">
                          {{ school.school_name }}
                        </a>
                      {% else %}
                        {{ school.school_name }}
                      {% endif %}
                      {% if not forloop.last %}, {% endif %}
                    </span>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </section>


<!-- Bootstrap Modal -->
    <div class="modal fade" id="demoModal" tabindex="-1" aria-labelledby="demoModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="demoModalLabel">Demo Video</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body p-0">
            <div class="ratio ratio-16x9">
              <iframe id="demoVideo" src="" title="Demo Video" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const demoBtn = document.getElementById('demoBtn');
        const demoVideo = document.getElementById('demoVideo');
        const demoModalEl = document.getElementById('demoModal');
        const demoModal = new bootstrap.Modal(demoModalEl);

        // List of YouTube URLs (regular, shortened, or watch links)
        const videos = [
            "https://youtu.be/IyUnskXEAp8?si=VO_18RC819z7a0n3",
            "https://www.youtube.com/watch?v=3JZ_D3ELwOQ",
            "https://www.youtube.com/watch?v=tgbNymZ7vqY"
        ];

        // Convert any YouTube link to embed URL with autoplay & mute
        function toEmbedURL(url) {
            let videoId = "";
            const ytShort = url.match(/youtu\.be\/([^\?]+)/);
            const ytWatch = url.match(/v=([^&]+)/);

            if (ytShort) videoId = ytShort[1];
            else if (ytWatch) videoId = ytWatch[1];
            else return ""; // invalid URL

            return `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1`;
        }

        demoBtn.addEventListener('click', function() {
            // Pick a random video
            const randomVideo = videos[Math.floor(Math.random() * videos.length)];
            demoVideo.src = toEmbedURL(randomVideo);
            demoModal.show();
        });

        // Clear video when modal is closed
        demoModalEl.addEventListener('hidden.bs.modal', function () {
            demoVideo.src = "";
        });
    });
    </script>


        {% endblock %}